---
import { getCollection } from 'astro:content';
import Layout from '../layouts/Layout.astro';
import Card from '../components/Card.astro';

const allPosts = await getCollection('posts');
const sortedPosts = allPosts.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<Layout title="文章 - Astro Blog" description="言西早木的博客文章列表，分享技术、生活与灵感。">
	<main>
		<h1>我的 <span class="text-gradient">文章</span></h1>
		<ul role="list" class="link-card-grid">
			{sortedPosts.map((post) => (
				<Card 
					href={`/posts/${post.slug}`}
					title={post.data.title}
					body={post.data.description}
					date={post.data.pubDate}
				/>
			))}
			{sortedPosts.length === 0 && (
				<Card 
					href="#"
					title="暂无文章"
					body="请稍后再来查看。"
				/>
			)}
		</ul>
	</main>
</Layout>

<style>
	main {
		margin: auto;
		padding: 2rem 1rem;
		max-width: 900px;
	}
	h1 {
		font-size: 2.5rem;
		font-weight: 700;
		line-height: 1.2;
		margin-bottom: 2.5rem;
		text-align: center;
		color: var(--c-text);
	}
	h1 span {
		position: relative;
		z-index: 1;
	}
	h1 span::after {
		content: '';
		position: absolute;
		bottom: 2px;
		left: 0;
		width: 100%;
		height: 8px;
		background: rgba(0,0,0,0.05);
		z-index: -1;
		border-radius: 4px;
	}
	
	.link-card-grid {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
		gap: 2rem;
		padding: 0;
		list-style: none;
	}
</style>
